<!doctype html>
<html lang="en"> 
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>StarShell Wallet developer links</title>

	<script type="module">

		function flow_params(gc_flow) {
			return new URLSearchParams({
				comm: 'query',
				key: 'test',
				data: JSON.stringify(gc_flow),
			}).toString();
		}

		function open_flow(gc_flow) {
			const p_url = `http://localhost:8128/src/entry/flow.html?${flow_params({
				...gc_flow,
				within: 'popout',
			})}`;

			window.open(p_url, '_blank');
		}

		function prompt_keplr() {
			open_flow({
				type: 'requestKeplr',
				value: {
					scheme: 'https',
					host: 'test.starshell.net',
					connections: {},
					pfp: '',
					name: 'Test App',
				},
			});
		}

		function request_sign() {
			open_flow({
				type: 'signAmino',
				value: {
					props: {
						preset: '',
						amino: {
							chain_id: 'pulsar-2',
							account_number: '67171',
							sequence: '1',
							fee: {
								gas:'175000',
								amount: [{
									amount: '43750',
									denom: 'uscrt',
								}],
							},
							msgs: [
								{
									type: 'wasm/MsgExecuteContract',
									value: {
										sender: 'secret1htrxpd3xvhc05qcxv3np6gp6cljaep4940wuf9',
										contract: 'secret14t6wd3kxf4j0c9jvhzxx0vud23v88vjl4u5r92',
										msg: 'en7Px/nk35UbW/q+8KXAu0OhuKdopVA+WrRZ4d4dV4+Sdb5u7qrcINOG9oDs9uYvsLBB8ArrB2vvxmxg8y/hBtidpoHSRt5/FfGe2gZhsg860jOHFSSrVtpyV8tZRJ/Ah2USN4Y9LynYxRmXuK/ZzsbqIQP3LzAGu+OjHpC5VVYwa8zrlt5yiNXTlmb6XMd4HYQl5bz2KwJn45xJEheKSyyzIhGVIgjxK+7OOliKmVXXh802hvL+qGSJS5wu6abbJYe1Q3lY6mk/XkDfWBRZynh+q/vp2v5GdIkZDAJjidB2whqKmqBbtgVDIDT2mWYAFxvX60dy2apZ1xZhSShXIpopwNvaitechTyBd4ECze4=',
										sent_funds:[]
									},
								},
							],
							memo:'',
						},
					},
					appPath: '/scheme.https/host.testnet.certup.net',
					chainPath: '/family.cosmos/chain.pulsar-2',
					accountPath: '/family.cosmos/account.AjV8N4EReZ9QueF6/UtEEI3USWIV696QcmEazn10XWaX',
				},
				page: {
					windowId: 480405483,
					tabId: 480405484,
					href: 'https://testnet.certup.net/issuers',
				},
			});
		}

		function request_sign_arb() {
			open_flow({
				type: 'signAmino',
				value: {
					props: {
						preset: '',
						amino: {
							"chain_id": "pulsar-2",
							"account_number": "67171",
							"sequence": "1",
							"fee":
							{
								"gas": "20000",
								"amount":
								[
										{
											"amount": "2000",
											"denom": "uscrt"
										}
								]
							},
							"msgs":
							[
								{
										"type": "cosmos-sdk/MsgSend",
										"value":
										{
											"from_address": "secret1htrxpd3xvhc05qcxv3np6gp6cljaep4940wuf9",
											"to_address": "secret1pvhx4llzxa7cs05hxxf45rpss69j00p7tq9qxx",
											"amount":
											[
												{
														"amount": "5100000",
														"denom": "uscrt"
												}
											]
										}
								}
							],
							"memo": ""
						},
					},
					appPath: '/scheme.https/host.app.starshell.net',
					chainPath: '/family.cosmos/chain.pulsar-2',
					accountPath: '/family.cosmos/account.AjV8N4EReZ9QueF6/UtEEI3USWIV696QcmEazn10XWaX',
				},
				page: {
					href: 'https://app.starshell.net',
				},
			});
		}


		function prompt_connection() {
			open_flow({
				type: 'requestConnection',
				value: {
					app: {
						scheme: 'http',
						host: 'localhost:3001',
						name: 'StarShell Wallet sample app',
						pfp: 'pfp:http://localhost:3001',
						connections: {},
					},
					chains: {
						"cosmos:pulsar-2": {
							"namespace": "cosmos",
							"reference": "secret-4",
							"name": "Secret Network",
							"pfp": "/template.pfp/uuid.2",
							"coins": {
								"SCRT": {
									"name": "SCRT",
									"denom": "uscrt",
									"decimals": 6,
									"pfp": "",
									"extra": {
										"coingecko_id": "secret"
									}
								}
							},
							"feeCoinIds": [
								"SCRT"
							],
							"stakeCoinIds": [
								"SCRT"
							],
							"slip44s": [
								{
									"coinType": 529
								},
								{
									"coinType": 118
								}
							],
							"bech32s": {
								"acc": "secret",
								"accpub": "secretpub",
								"valoper": "secretvaloper",
								"valoperpub": "secretvaloperpub",
								"valcons": "secretvalcons",
								"valconspub": "secretvalconspub",
							},
							"tokenInterfaces": [],
							"blockExplorer": {
								"base": "https://mintscan.io/{chain_prefix}",
								"block": "/blocks/{height}",
								"account": "/account/{address}",
								"contract": "/account/{address}",
								"validator": "/validators/{address}",
								"transaction": "/txs/{hash}"
							}
						},
					},
					sessions: {
						'demo': {
							caip2: 'cosmos:pulsar-2',
							doxx: {
								name: true,
								address: {
									justification: 'This is the justification.',
								},
							},
							query: {
								node: {
									justification: `Don't enable this option`,
								},
							},
							broadcast: {},
						},

						// 'arg': {
						// 	caip2: 'cosmos:theta-testnet-001',
						// 	doxx: {
						// 		name: true,
						// 		address: {
						// 			justification: 'This is the justification.',
						// 		},
						// 	},
						// },
					},
				},	
			})
		}

		window.addEventListener('DOMContentLoaded', () => {
			document.getElementById('keplr').onclick = prompt_keplr;
			document.getElementById('amino').onclick = request_sign;
			document.getElementById('connect').onclick = prompt_connection;
			document.getElementById('message').onclick = request_sign_arb;
		});
		

		({
			chains: {
				'cosmos:secret-4': {
					pfp: '/secret-4.svg',
				},
				'cosmos:cosmos-hub-3': {

				},
			},

			sessions: {
				'hub': {
					caip2: 'cosmos:cosmos-hub-3',
					ibc: {},
					broadcast: {},
				},

				'main': {
					caip2: 'cosmos:secret-4',
					broadcast: {},
				},

				'alt': {
					caip2: 'cosmos:secret-4',
					broadcast: {},
				},

				'validator': {
					caip2: 'cosmos:secret-4',
					broadcast: {},
				},
			},

			accounts: {
				seed: {
					hrp: 'acc',
					sessions: {
						hub: {},
						main: {},
					},
					name: '',
					description: '',
				},
				anon: {
					hrp: 'acc',
					sessions: {
						alt: {},
					},
					name: '',
					description: '',
				},
				// valoper: {
				// 	hrp: 'valoper',
				// 	sessions: {
				// 		validator: {},
				// 	},
				// 	name: 'Validator',
				// 	description: 'The ',
				// },
			},

			conflicts: [
				['a', 'b'],
			]
		})

	</script>
</head>
<body>

	<a id="keplr">Open Keplr Flow</a>

	<br />

	<a id="amino">Sign Amino</a>

	<br />

	<a id="connect">Open Connection Flow</a>

	<br />

	<a id="message">Sign Message</a>
	
</body>